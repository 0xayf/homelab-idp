apiVersion: apiextensions.crossplane.io/v2
kind: CompositeResourceDefinition
metadata:
  name: authroles.secrets.platform.lab
spec:
  group: secrets.platform.lab
  names:
    kind: AuthRole
    plural: authroles
  versions:
    - name: v1alpha1
      served: true
      referenceable: true
      schema:
        openAPIV3Schema:
          type: object
          properties:
            spec:
              type: object
              properties:
                backend:
                  type: string
                  description: Vault Kubernetes auth backend path.
                  default: kubernetes
                roleName:
                  type: string
                  description: Vault auth role name. Defaults to metadata.name.
                boundServiceAccountNames:
                  type: array
                  description: Kubernetes service accounts allowed to authenticate.
                  items:
                    type: string
                  default:
                    - external-secrets
                boundServiceAccountNamespaces:
                  type: array
                  description: Kubernetes namespaces allowed to authenticate. Defaults to claim namespace.
                  items:
                    type: string
                policyNames:
                  type: array
                  description: Vault policies attached to tokens from this role.
                  items:
                    type: string
                tokenTtl:
                  type: integer
                  description: Token TTL in seconds.
                  default: 3600
              required:
                - policyNames
            status:
              type: object
              properties:
                roleName:
                  type: string
                  description: Effective Vault role name.
